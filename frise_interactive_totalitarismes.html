<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Frise interactive avec filtres</title>
  <style>
    body{
      margin:0;
      font-family:Inter,system-ui,Roboto,Arial;
      /* Adapting background to match index.html professional theme */
      background: 
        linear-gradient(135deg, #0f0f0f 0%, #1a1a1a 25%, #141414 50%, #1a1a1a 75%, #0f0f0f 100%),
        radial-gradient(circle at 20% 80%, rgba(139, 69, 19, 0.08) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(25, 25, 112, 0.06) 0%, transparent 50%);
      background-size: 400% 400%, 100% 100%, 100% 100%;
      animation: subtleShift 30s ease infinite;
      color:#e8e8e8;
      display:flex;
      flex-direction:column;
      align-items:center;
      min-height:100vh;
      position: relative;
      overflow-x: hidden;
    }

    /* Adding professional background animation matching index.html */
    @keyframes subtleShift {
      0%, 100% { background-position: 0% 50%, 0% 0%, 100% 100%; }
      50% { background-position: 100% 50%, 50% 50%, 0% 0%; }
    }

    /* Replacing flashy particles with subtle academic texture */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: 
        linear-gradient(90deg, rgba(139, 69, 19, 0.02) 1px, transparent 1px),
        linear-gradient(rgba(139, 69, 19, 0.02) 1px, transparent 1px);
      background-size: 50px 50px;
      opacity: 0.3;
      pointer-events: none;
      z-index: -1;
    }

    /* Removing particles container styles */
    .particles-container {
      display: none;
    }

    .particle {
      display: none;
    }

    /* Professional header with academic colors matching index.html */
    h1{
      margin:20px;
      font-size:1.8rem;
      font-weight:600;
      background: linear-gradient(135deg, #f0f0f0 0%, #d2b48c 50%, #c0c0c0 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      position: relative;
      z-index: 10;
      animation: subtleTextShimmer 8s ease-in-out infinite;
    }

    /* Professional text shimmer matching index.html */
    @keyframes subtleTextShimmer {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    /* Professional controls with academic colors */
    #controls{
      margin:15px;
      display:flex;
      flex-wrap:wrap;
      gap:20px;
      background: 
        linear-gradient(135deg, rgba(20, 20, 20, 0.95) 0%, rgba(35, 35, 35, 0.9) 100%),
        linear-gradient(45deg, rgba(139, 69, 19, 0.1) 0%, transparent 50%);
      padding:15px 25px;
      border-radius:16px;
      border: 2px solid rgba(139, 69, 19, 0.3);
      box-shadow: 
        0 15px 35px rgba(0, 0, 0, 0.5),
        0 0 50px rgba(139, 69, 19, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(15px) saturate(150%);
      position: relative;
      z-index: 10;
      transition: all 0.3s ease;
    }

    #controls:hover {
      transform: translateY(-2px);
      box-shadow: 
        0 20px 45px rgba(0, 0, 0, 0.6),
        0 0 60px rgba(139, 69, 19, 0.15),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
    }

    /* Professional filter labels with academic theme */
    label{
      display:flex;
      align-items:center;
      gap:8px;
      cursor:pointer;
      font-size:0.95rem;
      background: rgba(255, 255, 255, 0.08);
      padding:8px 16px;
      border-radius:6px;
      transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      white-space:nowrap;
      color: #d1d1d1;
      border: 1px solid rgba(139, 69, 19, 0.3);
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(10px);
    }

    label::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(139, 69, 19, 0.1), transparent);
      transition: left 0.5s ease;
    }

    label:hover::before {
      left: 100%;
    }

    label:hover{
      background: rgba(139, 69, 19, 0.15);
      color: #d2b48c;
      transform: translateY(-2px) scale(1.05);
      border-color: rgba(139, 69, 19, 0.5);
      box-shadow: 0 8px 25px rgba(139, 69, 19, 0.2);
    }

    /* Professional checkbox styling */
    input[type="checkbox"]{
      accent-color:#d2b48c;
      transform:scale(1.3);
      cursor:pointer;
      filter: drop-shadow(0 0 5px rgba(139, 69, 19, 0.3));
    }

    /* Professional timeline container matching index.html */
    #timeline{
      width:90%;
      height:75vh;
      border: 1px solid rgba(139, 69, 19, 0.2);
      border-radius:12px;
      background: 
        linear-gradient(135deg, rgba(20, 20, 20, 0.95) 0%, rgba(35, 35, 35, 0.9) 100%),
        linear-gradient(45deg, rgba(139, 69, 19, 0.05) 0%, rgba(25, 25, 112, 0.03) 100%);
      margin-bottom:20px;
      box-shadow: 
        0 15px 35px rgba(0, 0, 0, 0.5),
        0 0 50px rgba(139, 69, 19, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(15px) saturate(150%);
      position: relative;
      overflow: hidden;
      transition: all 0.3s ease;
    }

    #timeline:hover {
      transform: translateY(-3px);
      box-shadow: 
        0 20px 45px rgba(0, 0, 0, 0.6),
        0 0 60px rgba(139, 69, 19, 0.15),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
    }

    #timeline::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(45deg, transparent 49%, rgba(139, 69, 19, 0.05) 50%, transparent 51%);
      background-size: 20px 20px;
      opacity: 0.2;
      pointer-events: none;
      animation: gridMove 25s linear infinite;
    }

    @keyframes gridMove {
      0% { transform: translate(0, 0); }
      100% { transform: translate(20px, 20px); }
    }

    /* Enhanced timeline items with better styling */
    .vis-item{
      border-radius:12px !important;
      padding:8px 12px;
      font-size:0.9rem;
      line-height:1.3rem;
      white-space:normal !important;
      word-wrap:break-word;
      cursor: pointer;
      color: #111;
      font-weight: 600;
      border: 2px solid rgba(0,0,0,0.2);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }

    .vis-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.3s ease;
    }

    .vis-item:hover::before {
      left: 100%;
    }

    .vis-item:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
      z-index: 100;
    }

    .vis-item.nazisme{
      background: linear-gradient(135deg, #f87171 0%, #dc2626 100%);
      border-color: #dc2626;
    }
    .vis-item.stalinisme{
      background: linear-gradient(135deg, #60a5fa 0%, #2563eb 100%);
      border-color: #2563eb;
    }
    .vis-item.fascisme{
      background: linear-gradient(135deg, #facc15 0%, #eab308 100%);
      border-color: #eab308;
    }

    /* Enhanced timeline axis styling */
    .vis-time-axis .vis-text{
      color:#9ca3af;
      font-weight: 500;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
    }
    .vis-panel.vis-background.vis-horizontal .vis-grid.vis-major{
      border-color:#374151;
      opacity: 0.6;
    }

    /* Professional modal with academic colors */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0,0,0,0.9);
      backdrop-filter: blur(15px);
      -webkit-backdrop-filter: blur(15px);
      animation: modalFadeIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    @keyframes modalFadeIn {
      from { 
        opacity: 0;
        backdrop-filter: blur(0px);
      }
      to { 
        opacity: 1;
        backdrop-filter: blur(15px);
      }
    }

    @keyframes modalSlideIn {
      from { 
        opacity: 0;
        transform: translateY(-50px) scale(0.9) rotateX(10deg);
      }
      to { 
        opacity: 1;
        transform: translateY(0) scale(1) rotateX(0deg);
      }
    }

    .modal-content {
      background: 
        linear-gradient(135deg, rgba(20, 20, 20, 0.95) 0%, rgba(35, 35, 35, 0.9) 100%),
        linear-gradient(45deg, rgba(139, 69, 19, 0.1) 0%, transparent 50%);
      margin: 8% auto;
      padding: 40px;
      border: 2px solid rgba(139, 69, 19, 0.3);
      width: 85%;
      max-width: 700px;
      color: #e8e8e8;
      border-radius: 12px;
      position: relative;
      box-shadow: 
        0 15px 35px rgba(0, 0, 0, 0.5),
        0 0 50px rgba(139, 69, 19, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
      animation: modalSlideIn 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
      backdrop-filter: blur(15px) saturate(150%);
      -webkit-backdrop-filter: blur(15px) saturate(150%);
      transform-style: preserve-3d;
    }

    .modal-content::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: radial-gradient(circle at 30% 30%, rgba(139, 69, 19, 0.05) 0%, transparent 70%);
      border-radius: 12px;
      pointer-events: none;
    }

    /* Enhanced close button with better UX */
    .close {
      position: absolute;
      top: 20px;
      right: 24px;
      color: #888;
      font-size: 28px;
      font-weight: 300;
      padding: 0;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      line-height: 1;
      text-align: center;
    }

    .close:hover,
    .close:focus {
      color: #f5f5f5;
      background: rgba(0, 212, 255, 0.1);
      border-color: rgba(0, 212, 255, 0.3);
      text-decoration: none;
    }

    /* Professional modal title with academic colors */
    #modalTitle {
      background: linear-gradient(135deg, #f0f0f0 0%, #d2b48c 50%, #c0c0c0 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-top: 0;
      margin-bottom: 24px;
      font-size: 2rem;
      font-weight: 700;
      line-height: 1.2;
      letter-spacing: -0.02em;
      position: relative;
      z-index: 2;
    }

    #modalContent {
      font-size: 1.15rem;
      line-height: 1.7;
      color: #b8b8b8;
      margin-bottom: 24px;
      text-align: justify;
      position: relative;
      z-index: 2;
    }

    #modalDate {
      font-size: 1rem;
      color: #d2b48c;
      font-style: italic;
      font-weight: 500;
      padding-top: 20px;
      border-top: 1px solid rgba(139, 69, 19, 0.2);
      margin-top: 24px;
      margin-bottom: 0;
      position: relative;
      z-index: 2;
    }

    /* Professional timeline controls */
    .timeline-controls {
      position: absolute;
      top: 20px;
      right: 20px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      z-index: 100;
    }

    .timeline-btn {
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(139, 69, 19, 0.3);
      border-radius: 6px;
      color: #d2b48c;
      padding: 8px 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.9rem;
      backdrop-filter: blur(10px);
    }

    .timeline-btn:hover {
      background: rgba(139, 69, 19, 0.15);
      transform: scale(1.05);
      box-shadow: 0 4px 15px rgba(139, 69, 19, 0.2);
    }

    /* Responsive enhancements */
    @media (max-width: 768px) {
      .modal-content {
        width: 95%;
        margin: 15% auto;
        padding: 28px;
        border-radius: 20px;
      }
      
      #modalTitle {
        font-size: 1.6rem;
      }
      
      #modalContent {
        font-size: 1rem;
      }

      .timeline-controls {
        display: none;
      }
    }
  </style>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" rel="stylesheet"/>
</head>
<body>
  <!-- Adding particles container -->
  <div class="particles-container" id="particlesContainer"></div>
  
  <h1>Frise chronologique des régimes totalitaires</h1>
  <div id="controls">
    <label><input type="checkbox" id="nazisme" checked> Nazisme</label>
    <label><input type="checkbox" id="stalinisme" checked> Stalinisme</label>
    <label><input type="checkbox" id="fascisme" checked> Fascisme</label>
  </div>
  <div id="timeline">
    <!-- Adding timeline controls -->
    <div class="timeline-controls">
      <button class="timeline-btn" onclick="zoomIn()">🔍+</button>
      <button class="timeline-btn" onclick="zoomOut()">🔍-</button>
      <button class="timeline-btn" onclick="resetView()">⌂</button>
    </div>
  </div>

  <div id="itemModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2 id="modalTitle"></h2>
      <p id="modalContent"></p>
      <p id="modalDate"></p>
    </div>
  </div>

  <script>
    var allItems = [
      // Nazisme
      {id: 1, content: 'Hitler nommé chancelier', start: '1933-01-30', group: 'nazisme', className:'nazisme'},
      {id: 2, content: 'Nuit de Cristal', start: '1938-11-09', group: 'nazisme', className:'nazisme', fullContent: 'Nuit de Cristal : violences antisémites massives, commerces et synagogues détruits.'},
      {id: 3, content: 'Invasion de la Pologne', start: '1939-09-01', group: 'nazisme', className:'nazisme', fullContent: 'Début de la Seconde Guerre mondiale avec l’invasion de la Pologne.'},
      {id: 11, content: 'Coup d\'Etat manqué ', start: '1923', group: 'nazisme', className:'nazisme', fullContent: 'Tentative de coup d\'État en 1923 contre la République de Weimar'},
      {id: 13, content: 'Création du NSDAP ', start: '1920-02-01', group: 'nazisme', className:'nazisme', fullContent: 'Le NSDAP (Nationalsozialistische Deutsche Arbeiterpartei) : le parti national-socialiste des travailleurs allemands et connu sous le nom "nazi". C\'est le parti dirigé par Hitlet et qui lui permet de prendre le pouvoir.'},
      
      // Stalinisme
      {id: 4, content: 'Grande Terreur en URSS', start: '1936-01-01', end: '1938-12-31', group: 'stalinisme', className:'stalinisme', fullContent: 'Grande Terreur en URSS : purges massives, goulags, exécutions.'},
      {id: 5, content: 'Mort de Staline', start: '1953-03-05', group: 'stalinisme', className:'stalinisme', fullContent: 'Mort de Staline et fin de son règne.'},
      {id: 10, content: 'Koulaks et antisoviétiques', start: '1932', group: 'stalinisme', className:'stalinisme', fullContent: 'Les Koulaks ont été fusillés (387 000) et déportés (1,8 million) entre 1929 et 1932, avec 250 000 morts en déportation.Les accusés de rumeurs antisoviétiques ou de propagande terroriste, comme Alexandra Petrovna Nikolaieva, ont été arrêtés, interrogés puis exécutés (fusillés)'},


      // Fascisme
      {id: 6, content: 'Mussolini prend le pouvoir', start: '1922-10-29', group: 'fascisme', className:'fascisme', fullContent: 'Mussolini prend le pouvoir en Italie après la Marche sur Rome.'},
      {id: 7, content: 'Invasion de l’Éthiopie', start: '1935-10-03', group: 'fascisme', className:'fascisme', fullContent: 'L\'Italie fasciste envahit l’Éthiopie, défiant la Société des Nations.'},
      {id: 8, content: 'Chute de Mussolini', start: '1943-07-25', group: 'fascisme', className:'fascisme', fullContent: 'Mussolini est déchu de ses fonctions et arrêté sur ordre du roi Victor-Emmanuel III.'},
      {id: 9, content: 'Faisceaux italiens', start: '1919-03-23', group: 'fascisme', className:'fascisme', fullContent: 'Fondation des Faisceaux italiens de combat par Mussolini, précurseur du Parti national fasciste.'},
      {id: 12, content: 'Marches sur Rome', start: '1922-10-27', group: 'fascisme', className:'fascisme', fullContent: 'La marche sur Rome est une marche paramilitaire menée par les faisceaux italiens de Mussolini.'},
    ];

    // Ajout d'un offset pour les éléments ayant la même date
    allItems.forEach((item, index) => {
      const sameDateItems = allItems.filter(i => i.start === item.start);
      if (sameDateItems.length > 1) {
        item.group = 'group-' + index; // Crée un groupe unique pour chaque élément
      }
    });

    var container = document.getElementById('timeline');
    var dataset = new vis.DataSet(allItems);

    var options = {
      editable: false,
      zoomable: true,
      stack: true,
      orientation: 'top',
      margin: {item: 25},
      showCurrentTime: false,
      tooltip: {
        followMouse: true,
        overflowMethod: 'cap'
      },
      zoomMin: 1000 * 60 * 60 * 24 * 30, // 1 month
      zoomMax: 1000 * 60 * 60 * 24 * 365 * 50, // 50 years
      animation: {
        duration: 500,
        easingFunction: 'easeInOutCubic'
      }
    };

    var timeline = new vis.Timeline(container, dataset, options);

    // Récupération des éléments du Modal
    var modal = document.getElementById("itemModal");
    var span = document.getElementsByClassName("close")[0];

    // Fonction pour ouvrir le modal avec les détails
    function openModal(item) {
      // 1. On vide la timeline
      dataset.clear();

      // 2. On remplit le contenu du modal
      document.getElementById('modalTitle').innerText = item.content;
      document.getElementById('modalContent').innerText = item.fullContent || ''; // Utilise fullContent si disponible
      let dateText = 'Date : ' + new Date(item.start).toLocaleDateString('fr-FR');
      if (item.end) {
        dateText += ' au ' + new Date(item.end).toLocaleDateString('fr-FR');
      }
      document.getElementById('modalDate').innerText = dateText;

      // 3. On affiche le modal
      modal.style.display = "block";
    }

    function closeModal() {
        modal.style.display = "none";
        // On recharge la timeline en appliquant les filtres
        updateFilter();
    }

    // Quand on clique sur (x), on ferme le modal et on recharge la frise
    span.onclick = function() {
        closeModal();
    };

    // Quand on clique en dehors du modal, on le ferme et on recharge la frise
    window.onclick = function(event) {
      if (event.target == modal) {
        closeModal();
      }
    }

    // Quand on clique sur un item, on ouvre le modal
    timeline.on('click', function (properties) {
      var eventId = properties.item;
      if (eventId) {
        var item = allItems.find(i => i.id === eventId); // Récupère l'item depuis la source originale
        openModal(item);
      }
    });

    function updateFilter(){
      var showNazisme = document.getElementById('nazisme').checked;
      var showStalinisme = document.getElementById('stalinisme').checked;
      var showFascisme = document.getElementById('fascisme').checked;

      var filtered = allItems.filter(item => {
        if(item.group === 'nazisme' && !showNazisme) return false;
        if(item.group === 'stalinisme' && !showStalinisme) return false;
        if(item.group === 'fascisme' && !showFascisme) return false;
        return true;
      });

      dataset.clear();
      dataset.add(filtered);
    }

    document.getElementById('nazisme').addEventListener('change', updateFilter);
    document.getElementById('stalinisme').addEventListener('change', updateFilter);
    document.getElementById('fascisme').addEventListener('change', updateFilter);

    function createParticle() {
      const particle = document.createElement('div');
      particle.className = 'particle';
      
      const size = Math.random() * 3 + 1;
      const startX = Math.random() * window.innerWidth;
      const duration = Math.random() * 15 + 10;
      
      particle.style.width = size + 'px';
      particle.style.height = size + 'px';
      particle.style.left = startX + 'px';
      particle.style.animationDuration = duration + 's';
      
      document.getElementById('particlesContainer').appendChild(particle);
      
      setTimeout(() => {
        particle.remove();
      }, duration * 1000);
    }

    // Create particles periodically
    if (window.innerWidth > 768) {
      setInterval(createParticle, 400);
    }

    function zoomIn() {
      timeline.zoomIn(0.2);
    }

    function zoomOut() {
      timeline.zoomOut(0.2);
    }

    function resetView() {
      timeline.fit();
    }

    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape' && modal.style.display === 'block') {
        closeModal();
      }
    });

    timeline.on('select', function (properties) {
      if (properties.items.length > 0) {
        timeline.focus(properties.items[0], {
          animation: {
            duration: 500,
            easingFunction: 'easeInOutCubic'
          }
        });
      }
    });
  </script>
</body>
</html>
